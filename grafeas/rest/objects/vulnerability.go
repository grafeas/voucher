package objects

//VulnerabilitySeverity based on
//https://github.com/grafeas/client-go/blob/master/0.1.0/model_vulnerability_severity.go
type VulnerabilitySeverity string

//consts
const (
	SeverityUnspecified VulnerabilitySeverity = "SEVERITY_UNSPECIFIED"
	SeverityMinimal     VulnerabilitySeverity = "MINIMAL"
	SeverityLow         VulnerabilitySeverity = "LOW"
	SeverityMedium      VulnerabilitySeverity = "MEDIUM"
	SeverityHigh        VulnerabilitySeverity = "HIGH"
	SeverityCritical    VulnerabilitySeverity = "CRITICAL"
)

//Vulnerability based on
//https://github.com/grafeas/client-go/blob/master/0.1.0/model_vulnerability_vulnerability.go
type Vulnerability struct {
	CvssScore      float32                      `json:"cvssScore,omitempty"`
	Severity       *VulnerabilitySeverity       `json:"severity,omitempty"`
	Details        []VulnerabilityData          `json:"details,omitempty"`
	CvssV3         *VulnerabilityCvsSv3         `json:"cvssV3,omitempty"`
	WindowsDetails []VulnerabilityWindowsDetail `json:"windowsDetails,omitempty"`
}

//VulnerabilityData based on
//https://github.com/grafeas/client-go/blob/39fa98b49d38de3942716c0f58f3505012415470/0.1.0/model_vulnerability_detail.go
type VulnerabilityData struct {
	CpeURI             string                 `json:"cpeUri,omitempty"`
	Package            string                 `json:"package,omitempty"` //required
	MinAffectedVersion *PackageVersion        `json:"minAffected_version,omitempty"`
	SeverityName       string                 `json:"severityName,omitempty"`
	Description        string                 `json:"description,omitempty"`
	FixedLocation      *VulnerabilityLocation `json:"fixedLocation,omitempty"`
	PackageType        string                 `json:"packageType,omitempty"`
	IsObsolete         bool                   `json:"isObsolete,omitempty"`
}

//VulnerabilityLocation based on
//https://github.com/grafeas/client-go/blob/master/0.1.0/model_vulnerability_vulnerability_location.go
type VulnerabilityLocation struct {
	CpeURI  string          `json:"cpeUri,omitempty"`  //required
	Package string          `json:"package,omitempty"` //required
	Version *PackageVersion `json:"version,omitempty"` //required
}

//VulnerabilityWindowsDetail based on
//https://github.com/grafeas/client-go/blob/master/0.1.0/model_vulnerability_windows_detail.go
type VulnerabilityWindowsDetail struct {
	CpeURI      string                       `json:"cpeUri,omitempty"` //required
	Name        string                       `json:"name,omitempty"`   //required
	Description string                       `json:"description,omitempty"`
	FixingKbs   []WindowsDetailKnowledgeBase `json:"fixingKbs,omitempty"` //required
}

//WindowsDetailKnowledgeBase based on
//https://github.com/grafeas/client-go/blob/master/0.1.0/model_windows_detail_knowledge_base.go
type WindowsDetailKnowledgeBase struct {
	Name string `json:"name,omitempty"`
	URL  string `json:"url,omitempty"`
}

//vulnerability for occurrence

//VulnerabilityDetails based on
//https://github.com/grafeas/client-go/blob/master/0.1.0/model_v1beta1vulnerability_details.go
type VulnerabilityDetails struct {
	Type              string                      `json:"type,omitempty"`
	Severity          *VulnerabilitySeverity      `json:"severity,omitempty"`         //output only
	CvssScore         float32                     `json:"cvssScore,omitempty"`        //output only
	PackageIssue      []VulnerabilityPackageIssue `json:"packageIssue,omitempty"`     //required
	ShortDescription  string                      `json:"shortDescription,omitempty"` //output only
	LongDescription   string                      `json:"longDescription,omitempty"`  //output only
	RelatedURLs       []RelatedURL                `json:"relatedUrls,omitempty"`      //output only
	EffectiveSeverity *VulnerabilitySeverity      `json:"effectiveSeverity,omitempty"`
}

//VulnerabilityPackageIssue based on
//https://github.com/grafeas/client-go/blob/master/0.1.0/model_vulnerability_package_issue.go
type VulnerabilityPackageIssue struct {
	AffectedLocation *VulnerabilityLocation `json:"affectedLocation,omitempty"` //required
	FixedLocation    *VulnerabilityLocation `json:"fixedLocation,omitempty"`
}

//VulnerabilityCvsSv3 based on
//https://github.com/grafeas/client-go/blob/master/0.1.0/model_vulnerability_cvs_sv3.go
type VulnerabilityCvsSv3 struct {
	BaseScore             float32                   `json:"baseScore,omitempty"`
	ExploitabilityScore   float32                   `json:"exploitabilityScore,omitempty"`
	ImpactScore           float32                   `json:"impactScore,omitempty"`
	AttackVector          *CvsSv3AttackVector       `json:"attackVector,omitempty"`
	AttackComplexity      *CvsSv3AttackComplexity   `json:"attackComplexity,omitempty"`
	PrivilegesRequired    *CvsSv3PrivilegesRequired `json:"privilegesRequired,omitempty"`
	UserInteraction       *CvsSv3UserInteraction    `json:"userInteraction,omitempty"`
	Scope                 *CvsSv3Scope              `json:"scope,omitempty"`
	ConfidentialityImpact *CvsSv3Impact             `json:"confidentialityImpact,omitempty"`
	IntegrityImpact       *CvsSv3Impact             `json:"integrityImpact,omitempty"`
	AvailabilityImpact    *CvsSv3Impact             `json:"availabilityImpact,omitempty"`
}

//CvsSv3AttackVector based on https://github.com/grafeas/client-go/blob/master/0.1.0/model_cvs_sv3_attack_vector.go
type CvsSv3AttackVector string

//CvsSv3AttackComplexity based on https://github.com/grafeas/client-go/blob/master/0.1.0/model_cvs_sv3_attack_complexity.go
type CvsSv3AttackComplexity string

//CvsSv3PrivilegesRequired based on https://github.com/grafeas/client-go/blob/master/0.1.0/model_cvs_sv3_privileges_required.go
type CvsSv3PrivilegesRequired string

//CvsSv3UserInteraction based on https://github.com/grafeas/client-go/blob/master/0.1.0/model_cvs_sv3_user_interaction.go
type CvsSv3UserInteraction string

//CvsSv3Scope based on https://github.com/grafeas/client-go/blob/master/0.1.0/model_cvs_sv3_scope.go
type CvsSv3Scope string

//CvsSv3Impact based on https://github.com/grafeas/client-go/blob/master/0.1.0/model_cvs_sv3_impact.go
type CvsSv3Impact string

//consts
const (
	CvsSv3AttackComplexityUnspecified CvsSv3AttackComplexity = "ATTACK_COMPLEXITY_UNSPECIFIED"
	CvsSv3AttackComplexityLow         CvsSv3AttackComplexity = "ATTACK_COMPLEXITY_LOW"
	CvsSv3AttackComplexityHigh        CvsSv3AttackComplexity = "ATTACK_COMPLEXITY_HIGH"

	CvsSv3AttackVectorUnspecified CvsSv3AttackVector = "ATTACK_VECTOR_UNSPECIFIED"
	CvsSv3AttackVectorNetwork     CvsSv3AttackVector = "ATTACK_VECTOR_NETWORK"
	CvsSv3AttackVectorAdjacent    CvsSv3AttackVector = "ATTACK_VECTOR_ADJACENT"
	CvsSv3AttackVectorLocal       CvsSv3AttackVector = "ATTACK_VECTOR_LOCAL"
	CvsSv3AttackVectorPhysical    CvsSv3AttackVector = "ATTACK_VECTOR_PHYSICAL"

	CvsSv3ImpactUnspecified CvsSv3Impact = "IMPACT_UNSPECIFIED"
	CvsSv3ImpactHigh        CvsSv3Impact = "IMPACT_HIGH"
	CvsSv3ImpactLow         CvsSv3Impact = "IMPACT_LOW"
	CvsSv3ImpactNone        CvsSv3Impact = "IMPACT_NONE"

	CvsSv3PrivilegesRequiredUnspecified CvsSv3PrivilegesRequired = "PRIVILEGES_REQUIRED_UNSPECIFIED"
	CvsSv3PrivilegesRequiredNone        CvsSv3PrivilegesRequired = "PRIVILEGES_REQUIRED_NONE"
	CvsSv3PrivilegesRequiredLow         CvsSv3PrivilegesRequired = "PRIVILEGES_REQUIRED_LOW"
	CvsSv3PrivilegesRequiredHigh        CvsSv3PrivilegesRequired = "PRIVILEGES_REQUIRED_HIGH"

	CvsSv3ScopeUnspecified CvsSv3Scope = "SCOPE_UNSPECIFIED"
	CvsSv3ScopeUnchanged   CvsSv3Scope = "SCOPE_UNCHANGED"
	CvsSv3ScopeChanged     CvsSv3Scope = "SCOPE_CHANGED"

	CvsSv3UserInteractionUnspecified CvsSv3UserInteraction = "USER_INTERACTION_UNSPECIFIED"
	CvsSv3UserInteractionNone        CvsSv3UserInteraction = "USER_INTERACTION_NONE"
	CvsSv3UserInteractionRequired    CvsSv3UserInteraction = "USER_INTERACTION_REQUIRED"
)
