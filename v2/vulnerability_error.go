package voucher

import "fmt"

// VulnerabilitiesError is an error that also contains a list of vulnerabilities.
type VulnerabilitiesError struct {
	Vulnerabilities []Vulnerability
}

// Error returns the error message for the VulnerabilitiesError
func (err VulnerabilitiesError) Error() string {
	output := fmt.Sprintf("vulnernable to %d vulnerabilities: ", len(err.Vulnerabilities))

	for i, vulnerability := range err.Vulnerabilities {
		if i != 0 {
			output += ", "
		}
		output += fmt.Sprintf("%s (%s)", vulnerability.Name, vulnerability.Severity)
	}
	return output
}

// NewVulnerabilityError creates a new VulnerabilityError with the passed
// Vulnerabilities.
func NewVulnerabilityError(vuls []Vulnerability) (err error) {
	err = VulnerabilitiesError{
		Vulnerabilities: vuls,
	}
	return
}
